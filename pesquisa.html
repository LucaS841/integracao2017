<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="assets/img/marca-inf.png">

    <title>PPC - BES</title>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">

  </head>

  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top" style="background-color: #212121 !important;">
      <a class="navbar-brand" href="#">
         <img src="assets/img/marca-inf.png" width="30" height="30" alt="">
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Link</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="#">Disabled</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</a>
            <div class="dropdown-menu" aria-labelledby="dropdown01">
              <a class="dropdown-item" href="#">Action</a>
              <a class="dropdown-item" href="#">Another action</a>
              <a class="dropdown-item" href="#">Something else here</a>
            </div>
          </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
          <input class="form-control mr-sm-2" name="pesquisa" type="text" placeholder="Search" aria-label="Search" required>
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
      </div>
    </nav>

    <div class="container" id="resultado" style="margin-top: 100px">
      <div class="col-md-12 text-center">
        <img class="" style="width: 35%; max-width: 220px;" src="assets/img/loading.gif"/>
      </div>

    </div><!-- /.container -->


    <footer class="text-muted" style="background-color: #f7f7f7; position: absolute; bottom: 0; width: 100%;">
      <div class="container-fluid p-3 p-md-5">
        <a href="https://github.com/matheuspiment/integracao2017">GitHub</a></li>
        <p>Inspirado em <a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a>.</p>
        <p>Codigo licenciado <a rel="license noopener" href="https://github.com/matheuspiment/integracao2017/blob/master/LICENSE" target="_blank">MIT</a>, documentação <a rel="license noopener" href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.</p>
      </div>
    </footer>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
    <!-- <script>window.jQuery || document.write('<script src="assets/js/jquery.min.js"><\/script>')</script> -->
    <script src="assets/js/jquery-3.2.1.min.js"></script>
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>
    <script type="text/javascript">
      $( document ).ready(function() {

        // Função que captura os parâmetros passados pela URL
        function queryObj() {
          var result = {}, keyValuePairs = location.search.slice(1).split("&");
          keyValuePairs.forEach(function(keyValuePair) {
            keyValuePair = keyValuePair.split('=');
            result[decodeURIComponent(keyValuePair[0])] = decodeURIComponent(keyValuePair[1]) || '';
          });
          return result;
        }

        // Função que realiza a pesquisa no arquivo JSON
        function pesquisar(keyword) {

          var saida = '';
          var topicos = [];
          var palavraChave = [];

          $.getJSON("https://raw.githubusercontent.com/matheuspiment/integracao2017/master/dicionario.json", function(data) {
            topicos = data.topicos;

            for (i = 0; i < topicos.length; i++) {
              palavraChave = topicos[i].palavrasChave;

              for (j = 0; j < palavraChave.length; j++) {
                if (palavrasChave[j] == keyword) {
                  saida += '<div class="col-md-12">';
                  saida += '<a href="' + topicos[i].caminho + '">';
                  saida += '<h1>' + topicos[i].titulo + '</h1>';
                  saida += '<p>' + topicos[i].descricao + '</p>';
                  // saida += '<img src="' + bands[i].picture + '" alt="' + bands[i].name + '" title="' + bands[i].name + '">';
                  saida += '</a>';
                  saida += '</div>';
                }
              }
            }

            if (saida != "") {
              document.getElementById('resultado').innerHTML = saida;
              console.log(saida);
            } else {
              saida += '<div class="col-md-12">';
              saida += '<div class="alert alert-info" role="alert">';
              saida += 'Nenhum registro encontrado :(';
              saida += '</div>'
              saida += '</div>';
              document.getElementById('resultado').innerHTML = saida;
            }

          });
        }

        var minhaBusca = queryObj();
        var retornoBusca;

        retornoBusca = setTimeout(function(){
          pesquisar(minhaBusca.pesquisa);
        }, 2000);

      });
    </script>
  </body>
</html>
